<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Teams | Voicemail</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #eef1f6; color: #333; }
    .header { background: #5059C9; color: #fff; padding: 1rem 2rem; display: flex; align-items: center; justify-content: space-between; border-bottom: 4px solid #3d4291; }
    .header img { height: 36px; }
    .container { max-width: 860px; margin: 50px auto; background: #fff; padding: 2rem; border: 1px solid #ccc; }
    h2 { margin-top: 0; font-size: 24px; }
    .waveform {
      height: 20px;
      width: 100%;
      background: linear-gradient(90deg, #ddd 50%, #5059C9 50%);
      background-size: 200% 100%;
      background-position: 100% 0;
      transition: background-position 0.1s linear;
    }
    .controls { display: flex; align-items: center; justify-content: space-between; margin-top: 20px; }
    button {
      background: #5059C9; color: #fff; border: none;
      padding: 12px 24px; font-size: 16px;
      cursor: pointer;
    }
    .timecode { font-size: 14px; color: #555; }
  </style>
</head>
<body>
  <div class="header">
    <img src="data:image/jpeg;base64,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" alt="Teams Logo">
    <span>Microsoft Teams</span>
  </div>
  <div class="container">
    <h2>Voicemail Playback</h2>
    <div class="waveform" id="waveform"></div>
    <div class="controls">
      <button onclick="playVoicemail()">â–¶ Play Voicemail</button>
      <span class="timecode" id="timestamp">0:00 / 0:00</span>
    </div>
  </div>

  <script>
    const voicemailText = "Can you check your messages? I have sent over...";
    const waveform = document.getElementById('waveform');
    const timestamp = document.getElementById('timestamp');
    const synth = window.speechSynthesis;

    let duration = 0;
    let startTime = 0;
    let interval = null;

    function playVoicemail() {
      if (synth.speaking) synth.cancel();

      const utterance = new SpeechSynthesisUtterance(voicemailText);
      utterance.onstart = () => {
        duration = Math.max(2, Math.floor(voicemailText.length / 8));
        startTime = Date.now();
        updateWaveform();
        interval = setInterval(updateWaveform, 100);
      };
      utterance.onend = () => {
        clearInterval(interval);
        waveform.style.backgroundPosition = '100% 0';
        timestamp.textContent = `${formatTime(duration)} / ${formatTime(duration)}`;
      };
      synth.speak(utterance);
    }

    function updateWaveform() {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const percent = Math.min(100, (elapsed / duration) * 100);
      waveform.style.backgroundPosition = `${100 - percent}% 0`;
      timestamp.textContent = `${formatTime(elapsed)} / ${formatTime(duration)}`;
    }

    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${m}:${s.toString().padStart(2, '0')}`;
    }
  </script>
</body>
</html>
